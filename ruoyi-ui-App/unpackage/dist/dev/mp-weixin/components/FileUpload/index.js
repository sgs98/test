(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/FileUpload/index"],{484:function(e,t,n){"use strict";n.r(t);var i=n(485),r=n(487);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n(489);var s,a=n(24),u=Object(a["default"])(r["default"],i["render"],i["staticRenderFns"],!1,null,"3e530c3b",null,!1,i["components"],s);u.options.__file="components/FileUpload/index.vue",t["default"]=u.exports},485:function(e,t,n){"use strict";n.r(t);var i=n(486);n.d(t,"render",(function(){return i["render"]})),n.d(t,"staticRenderFns",(function(){return i["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return i["recyclableRender"]})),n.d(t,"components",(function(){return i["components"]}))},486:function(e,t,n){"use strict";var i;n.r(t),n.d(t,"render",(function(){return r})),n.d(t,"staticRenderFns",(function(){return s})),n.d(t,"recyclableRender",(function(){return o})),n.d(t,"components",(function(){return i}));try{i={uniFilePicker:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker")]).then(n.bind(null,551))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,465))},uniPopupMessage:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-popup/components/uni-popup-message/uni-popup-message")]).then(n.bind(null,502))},uniPopupDialog:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog")]).then(n.bind(null,472))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,t=e.$createElement;e._self._c},o=!1,s=[];r._withStripped=!0},487:function(e,t,n){"use strict";n.r(t);var i=n(488),r=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=r.a},488:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(n(120)),r=n(17),o=n(180);function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,i,r,o,s){try{var a=e[o](s),u=a.value}catch(l){return void n(l)}a.done?t(u):Promise.resolve(u).then(i,r)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(e){a(o,i,r,s,u,"next",e)}function u(e){a(o,i,r,s,u,"throw",e)}s(void 0)}))}}var l={name:"FileUpload",props:{ossIds:[String,Object,Array],limit:{type:Number,default:5},fileSize:{type:Number,default:150},fileType:{type:Array,default:function(){return["doc","xls","ppt","txt","pdf","zip","rar","png","jpg","jpeg"]}}},data:function(){return{number:0,baseUrl:getApp().globalData.config.baseUrl,uploadFileUrl:getApp().globalData.config.baseUrl+"/system/oss/upload",formData:{Authorization:"Bearer "+(0,r.getToken)()},headers:{"content-type":"multipart/form-data"},uploadList:[],fileList:[],msgType:"",messageText:"",alertType:"",alertContent:"",tempItem:void 0}},watch:{ossIds:{handler:function(e){var t=this;return u(i.default.mark((function n(){var r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=11;break}if(1,!Array.isArray(e)){n.next=6;break}r=e,n.next=8;break;case 6:return n.next=8,(0,o.listByIds)(e).then((function(e){console.log(e),r=e.data.map((function(e){return e={name:e.originalName,url:e.url,fileId:e.ossId},e}))}));case 8:t.fileList=r.map((function(e){return e={name:e.name,url:e.url,fileId:e.ossId,extname:void 0,fileType:void 0,image:void 0,size:void 0},e.path=e.path,e})),n.next=13;break;case 11:return t.fileList=[],n.abrupt("return",[]);case 13:case"end":return n.stop()}}),n)})))()},deep:!0,immediate:!0}},computed:{},methods:{handleSelect:function(t){var n=this;return u(i.default.mark((function o(){var s;return i.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:n,s=t.tempFilePaths,e.uploadFile({url:n.uploadFileUrl,filePath:s[0],name:"file",formData:{Authorization:"Bearer "+(0,r.getToken)()},headers:{"content-type":"multipart/form-data"},success:function(e){var t=JSON.parse(e.data);200!=e.statusCode&&(n.msgType="error",n.messageText=e.errMsg,n.$refs.message.open()),200===t.code?(n.uploadList.push({name:t.data.fileName,url:t.data.url,fileId:t.data.ossId}),n.fileList=n.fileList.concat(n.uploadList),n.$emit("input",n.listToString(n.fileList)),n.msgType="success",n.messageText=t.msg,n.$refs.message.open()):(n.msgType="error",n.messageText=t.msg,n.$refs.message.open())}});case 3:case"end":return i.stop()}}),o)})))()},handleDelete:function(e){console.log(this.fileList);var t=e.tempFile.fileId;this.tempItem=e,this.alertType="warn",this.alertContent='是否确认删除OSS对象存储编号为"'+t+'"的数据项?',this.$refs.alertDialog.open()},dialogConfirm:function(){if(this.tempItem)return(0,o.delOss)(this.tempItem.tempFile.fileId);this.fileList.$remove(this.tempItem),this.$emit("input",this.listToString(this.fileList))},dialogClose:function(){console.log(this.tempItem.tempFile),this.fileList.push(this.tempItem.tempFile),console.log(this.fileList)},handleDownload:function(e){var t=this.fileList[e].ossId;this.$download.oss(t)},getFileName:function(e){return e.lastIndexOf("/")>-1?e.slice(e.lastIndexOf("/")+1):e},listToString:function(e,t){var n="";for(var i in t=t||",",e)n+=e[i].fileId+t;return""!=n?n.substr(0,n.length-1):""}}};t.default=l}).call(this,n(1)["default"])},489:function(e,t,n){"use strict";n.r(t);var i=n(490),r=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=r.a},490:function(e,t,n){}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/components/FileUpload/index.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/FileUpload/index-create-component',
    {
        'components/FileUpload/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(484))
        })
    },
    [['components/FileUpload/index-create-component']]
]);
